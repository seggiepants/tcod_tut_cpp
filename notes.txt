tutorial: https://www.roguebasin.com/index.php?title=Complete_roguelike_tutorial_using_C%2B%2B_and_libtcod_-_part_1:_setting_up
getting started docs: https://libtcod.readthedocs.io/en/latest/guides/getting-started.html
github: https://github.com/libtcod/libtcod

suggests vcpkg and cmake.

vcpkg: https://github.com/microsoft/vcpkg
cmake: https://cmake.org/

vcpkg: jump to getting started then unix

# linux
wants a sub-module so lets go back to the libtcod c++ tutorial and set that up.

Oh look a template already setup, lets use that (https://github.com/HexDecimal/libtcod-vcpkg-template).
git submodule update --init to grab vcpkg... takes a while to clone
a very long time, lets update CMakeLists.txt while waiting

changed the name and after failing a few times, the submodule init worked (had to login for some reason to a key chain thing)
cmake CMakeList.txt and now it is upgrading cmake -- grumble.

looks like it is now getting SDL2 (I thought I had that)
looks like I can pass in a define for emscripten, so that sounds nice.
https://github.com/HexDecimal/libtcod-vcpkg-template

More dependencies
sudo apt install libx11-dev libxft-dev libxext-dev
sudo apt install libwayland-dev libxkbcommon-dev libegl1-mesa-dev
sudo apt install libibus-1.0-dev

slow but we got there in the end. Changed the window title kept the rest and I now have an executable that says 'Hello World'

Now back to the tutorial, lets go back to the tutorial, and make the first program. A lot of stuff like include file already there from the template, plus a lot more the tutorial doesn't cover.
first off init_root is deprecated, shouldn't be used and doesn't work with emscripten.
looks like we are using SDL2 event handling instead of tcod. Will probably stay with that.
Can't use TCODConsole::isWindowClosed() use SDL2 it says.
Looks like we have a global console object instead of calling library function commands
g_context.present(g_console); instead of TCODConsole::flush(); with a global context and console.
we have print but no put_char lets try at. Have to add .ch at the end to get to the char, but it works and eventually 
I finish part 1: setting up. I also added [ESCAPE] to quit and you can use cursors or wasd to move. 

Did some looking not really seeing the map generation stuff I wanted, at least not in the readthedocs.io main sidebar. I do see a bsp.hpp file in the full api list of files.

Man alive it was painful trying to get github let me push to it. SSH vs HTTPS and a new SSH key. Misery all around.

-- 06 FEB 2024
-- Part 2 Map and Actors

Oh look I found a newer version of the tutorial this should solve everything right?
https://www.roguebasin.com/index.php?title=Complete_roguelike_tutorial_using_modern_C%2B%2B_and_libtcod
Nope, abandonded after one paragraph. Ok continue with the old one then.

lets start putting things on branches in git. I swear I used to do this a better way.
git branch 02_Map_and_Actors
git switch 02_Map_and_Actors

I also found a site with the python version of the tutorials (http://www.rogueliketutorials.com/) may want to check against it later to see if I am missing stuff.

I prefer .h or .hpp, but I will stick with the tutorial and use .hpp for this project

Needed to hack up the old main and bring over the template initialization due to deprecation. Quite a bit more code than before. Puzzled over if I should pass in argc, argv or the whole parameter block. Decided the parameters belonged more in the engine and passed in the arguments. Moved get data dir into engine too and added a isRunning flag. Compiled and .... TCODList is deprecated. Let me go swap it for a generic stl list groan.

ok, works as desired. Decided to take a screen shot for the readme. Speaking of which I should update that.

-- Part 03 Dungeon Building 
I decided I didn't want to use screen grabbers for the next screen shot. Found a nice screenshot function in the library coded up something to save a screenshot with increasing counter when you hit F10. Compile... and .... depreacated :(
I found TCOD_context_save_screenshot, but it uses the wrong context.

OK, does the context I am using have a screenshot function? Yes and it takes a std::filesystem::path too which I was using lets try that. Segmentation fault, core dumped() :(

Learned you can do
cmake -DCMAKE_BUILD_TYPE=Debug CMakeLists.txt
cmake -DCMAKE_BUILD_TYPE=Release CMakeLists.txt

changed to debug attached with gdb and it is in code that isn't mine :(

Thread 1 "tcod_tut_cpp" received signal SIGSEGV, Segmentation fault.
0x000055555586c182 in getPixelColorRGBA8 (r=0x7fffffffd638 "", g=0x7fffffffd63a "", b=0x7fffffffd63c "", a=0x7fffffffd63e "", in=0x0, i=0, mode=0x7fffffffde98) at /home/sgray/Documents/code/tcod_tut_cpp/vcpkg/buildtrees/lodepng/src/dcd7a6a84a-1b95b8ca64.clean/lodepng.c:3311

nope changing to .bmp from .png does nothing, dies same place doesn't detect file type or anything.
Stole some screenshot SDL2 code from Stack Overflow, that works but only saves as .BMP.  Without SDL_Image I think that is the best I can do. Anyway table this for now. Well one more thing, make sure it is not enabled in emscripten mode.

Trying to keep things clean so when I got an unused parameter warning, for the userdata in the bspListener I found out you can prepend __attribute__((unused)) to it to silence the error. Learn something new every day. Other than my foray into trying to get a better screenshot system. This went pretty smooth, and mostly as-is. I think there is a TCOD_Random vs TCODRandom error in the original text. I also used std::swap to try to be more modern c++ ish.

Spoke too soon, another core dump, is it the swap? Not this time: engine->player->x = (x1 + x2) / 2; I did have to switch from engine. to engine->, maybe the intellisense led me the wrong way. No compiler agrees with intellisense. I thought maybe I had map before player and a null pointer but it looks ok. Gdb says engine is a null pointer. Pointer must not be valid until after the constructor returns. I can either switch it back to a non-pointer object and remove the argc, argv parameters or move map creation out of the constructor. I don't really like either, but I think I will go with the prior. Closer to the original code. Now I get unused argc, argv, guess I will remove them. Looks like I didn't return a value either, add that, maybe that was the windows build problem. Almost working, I just don't have corridors. Is it the swap? Nope. It was digging doing a < instead of a <=.

By the way first split recursive in the tutorial is passing max when it should be min. Also rooms are reaching the screen edges when it shouldn't be. Core dump on exit that is not good. Got it once in gdb not in my thread can no longer reproduce :(

I think I got the bounds fixed. Passing in the room min size is too small when iterating min room size is where the bsp splitting stops but is also used to set the lower bound of the room when visiting. You can't have both the min size and a border. So I added two to the min room size for the splitting and use the normal min room size for the create room lower bound. Could get out of bounds numbers otherwise. The max swapped version in the tutorial wouldn't have the problem since it stopped much earlier.

